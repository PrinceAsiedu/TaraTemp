<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AfricaCERT Vulnerability Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 12px;
            line-height: 1.5;
            margin: 0;
            padding: 0;
            background-color: #fff;
        }

        .container {
            width: 100%;
            padding: 20px;
        }

        .header-table, .info-table, .details-table, .footer-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .header-table td {
            vertical-align: middle;
        }

        .title {
            font-size: 22px;
            font-weight: bold;
            text-align: center;
        }

        .africacert-logo {
            width: 100px;
        }

        .table th, .table td {
            border: 1px solid #000;
            padding: 8px;
        }

        .table th {
            background-color: #4CAF50;
            color: white;
        }

        .checkbox {
            width: 10px;
            height: 10px;
            border: 1px solid black;
            display: inline-block;
            margin-right: 5px;
        }

        .cvss {
            color: red;
            font-weight: bold;
        }

        .footer-text {
            text-align: center;
            font-size: 10px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <table class="header-table">
            <tr>
                <td><img class="africacert-logo" src="{{ logo_path }}" alt="AfricaCERT Logo"></td>
                <td class="title">AfricaCERT Vulnerability Report</td>
                <td>{{ data.product.title }}</td>
            </tr>
        </table>

        <!-- Report Details -->
        {% for report_item in data.report_items %}
        <h2>{{ report_item.name }}</h2>

        <!-- Confidentiality Section -->
        <table class="info-table">
            <tr>
                <td>Confidentiality</td>
                <td><div class="checkbox">{% if report_item.attrs.confidentiality == 'UNRESTRICTED' %}&#10003;{% endif %}</div> Unrestricted</td>
                <td><div class="checkbox">{% if report_item.attrs.confidentiality == 'CLASSIFIED' %}&#10003;{% endif %}</div> Classified</td>
                <td><div class="checkbox">{% if report_item.attrs.confidentiality == 'CONFIDENTIAL' %}&#10003;{% endif %}</div> Confidential</td>
                <td><div class="checkbox">{% if report_item.attrs.confidentiality == 'SECRET' %}&#10003;{% endif %}</div> Secret</td>
                <td><div class="checkbox">{% if report_item.attrs.confidentiality == 'TOP SECRET' %}&#10003;{% endif %}</div> Top Secret</td>
            </tr>
        </table>

        <!-- TLP Section -->
        <table class="info-table">
            <tr>
                <td>TLP</td>
                <td colspan="5">
                    {% if report_item.attrs.tlp == 'CLEAR' %}
                    <span style="background-color: black; color: white; padding: 5px;">TLP:CLEAR</span>
                    {% elif report_item.attrs.tlp == 'GREEN' %}
                    <span style="background-color: green; color: white; padding: 5px;">TLP:GREEN</span>
                    {% elif report_item.attrs.tlp == 'AMBER' %}
                    <span style="background-color: orange; color: white; padding: 5px;">TLP:AMBER</span>
                    {% elif report_item.attrs.tlp == 'RED' %}
                    <span style="background-color: red; color: white; padding: 5px;">TLP:RED</span>
                    {% endif %}
                </td>
            </tr>
        </table>

        <!-- CVSS Score -->
        <table class="info-table">
            <tr>
                <td>CVSS Vector</td>
                <td colspan="5"><span class="cvss">{{ report_item.attrs.cvss }}</span></td>
            </tr>
        </table>

        <!-- Description -->
        <table class="details-table">
            <tr><th>Description</th></tr>
            <tr><td>{{ report_item.attrs.description }}</td></tr>
        </table>

        <!-- Exposure and Update Dates -->
        <table class="details-table">
            <tr><th>Exposure Date</th><td>{{ report_item.attrs.exposure_date }}</td></tr>
            <tr><th>Update Date</th><td>{{ report_item.attrs.update_date }}</td></tr>
        </table>

        <!-- CVE -->
        <table class="details-table">
            <tr><th>CVE</th><td>{{ report_item.attrs.cve[0] }}</td></tr>
        </table>

        <!-- Impact -->
        <table class="details-table">
            <tr><th>Impact</th><td>{{ report_item.attrs.impact }}</td></tr>
        </table>
        <br>
        {% endfor %}

        <!-- Footer Section -->
        <table class="footer-table">
            <tr>
                <td class="footer-text">Â© 2024 AfricaCERT. All rights reserved. | Contact: info@africacert.org</td>
            </tr>
        </table>
    </div>
</body>
</html>
